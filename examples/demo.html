<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CkPrimitiveArray Component Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            padding: 2rem;
            background: #f5f5f5;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
            margin-bottom: 2rem;
            font-size: 2.5rem;
        }

        .section {
            margin-bottom: 3rem;
            padding: 1.5rem;
            background: #fafafa;
            border-radius: 6px;
            border-left: none;
        }

        .section h2 {
            color: #333;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .section p {
            color: #666;
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .demo-item {
            padding: 1rem;
            background: white;
            border-radius: 8px;
            border: 2px solid #e9ecef;
        }

        .demo-item h3 {
            font-size: 1rem;
            color: #495057;
            margin-bottom: 1rem;
        }

        .controls {
            margin-top: 1.5rem;
            padding: 1rem;
            background: white;
            border-radius: 8px;
        }

        .control-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: #495057;
            font-weight: 500;
        }

        input[type="text"],
        input[type="color"] {
            width: 100%;
            padding: 0.5rem;
            border: 2px solid #dee2e6;
            border-radius: 4px;
            font-size: 1rem;
        }

        input[type="text"]:focus,
        input[type="color"]:focus {
            outline: none;
            border-color: #667eea;
        }

        code {
            background: #282c34;
            color: #61dafb;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
        }

        pre {
            background: #282c34;
            color: #abb2bf;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin-top: 1rem;
        }

        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        .comment {
            color: #5c6370;
            font-style: italic;
        }

        .highlight {
            color: #e06c75;
        }

        .keyword {
            color: #c678dd;
        }

        .string {
            color: #98c379;
        }

        button {
            background: #333;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
        }

        #dynamic-demo {
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé® CkPrimitiveArray Component Demo</h1>

        <!-- Basic Usage -->
        <div class="section">
            <h2>1. Basic Usage</h2>
            <p>The simplest way to use the component with default values.</p>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>Default Component</h3>
                    <ck-primitive-array></ck-primitive-array>
                </div>
            </div>
            <pre><code><span class="keyword">&lt;ck-primitive-array&gt;&lt;/ck-primitive-array&gt;</span></code></pre>
        </div>

        <!-- Custom Name -->
        <div class="section">
            <h2>2. Custom Name</h2>
            <p>Customize the greeting message by setting the <code>name</code> attribute.</p>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>name="Developer"</h3>
                    <ck-primitive-array name="Developer"></ck-primitive-array>
                </div>
                <div class="demo-item">
                    <h3>name="Designer"</h3>
                    <ck-primitive-array name="Designer"></ck-primitive-array>
                </div>
                <div class="demo-item">
                    <h3>name="Product Manager"</h3>
                    <ck-primitive-array name="Product Manager"></ck-primitive-array>
                </div>
            </div>
            <pre><code><span class="keyword">&lt;ck-primitive-array</span> <span class="highlight">name</span>=<span class="string">"Developer"</span><span class="keyword">&gt;&lt;/ck-primitive-array&gt;</span></code></pre>
        </div>

        <!-- Custom Color -->
        <div class="section">
            <h2>3. Custom Color</h2>
            <p>Change the message color using the <code>color</code> attribute.</p>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>color="#e74c3c"</h3>
                    <ck-primitive-array name="Red Theme" color="#e74c3c"></ck-primitive-array>
                </div>
                <div class="demo-item">
                    <h3>color="#3498db"</h3>
                    <ck-primitive-array name="Blue Theme" color="#3498db"></ck-primitive-array>
                </div>
                <div class="demo-item">
                    <h3>color="#2ecc71"</h3>
                    <ck-primitive-array name="Green Theme" color="#2ecc71"></ck-primitive-array>
                </div>
            </div>
            <pre><code><span class="keyword">&lt;ck-primitive-array</span> <span class="highlight">name</span>=<span class="string">"Red Theme"</span> <span class="highlight">color</span>=<span class="string">"#e74c3c"</span><span class="keyword">&gt;&lt;/ck-primitive-array&gt;</span></code></pre>
        </div>

        <!-- JavaScript Control -->
        <div class="section">
            <h2>4. JavaScript Control</h2>
            <p>Dynamically update the component using JavaScript properties.</p>
            <div class="controls">
                <div class="control-group">
                    <label for="nameInput">Name:</label>
                    <input type="text" id="nameInput" placeholder="Enter a name" value="JavaScript User">
                </div>
                <div class="control-group">
                    <label for="colorInput">Color:</label>
                    <input type="color" id="colorInput" value="#9b59b6">
                </div>
            </div>
            <div id="dynamic-demo">
                <ck-primitive-array id="dynamicComponent" name="JavaScript User" color="#9b59b6"></ck-primitive-array>
            </div>
            <pre><code><span class="keyword">const</span> element = <span class="keyword">document</span>.querySelector(<span class="string">'ck-primitive-array'</span>);
element.<span class="highlight">name</span> = <span class="string">'JavaScript User'</span>;
element.<span class="highlight">color</span> = <span class="string">'#9b59b6'</span>;</code></pre>
        </div>

        <!-- Programmatic Creation -->
        <div class="section">
            <h2>5. Programmatic Creation</h2>
            <p>Create and configure components entirely via JavaScript.</p>
            <button id="createBtn">Create New Component</button>
            <div id="programmatic-container" style="margin-top: 1rem;"></div>
            <pre><code><span class="keyword">const</span> element = <span class="keyword">document</span>.createElement(<span class="string">'ck-primitive-array'</span>);
element.<span class="highlight">name</span> = <span class="string">'Dynamic'</span>;
element.<span class="highlight">color</span> = <span class="string">'#e67e22'</span>;
<span class="keyword">document</span>.body.appendChild(element);</code></pre>
        </div>

        <!-- Items Attribute -->
        <div class="section">
            <h2>6. Items Attribute - String Arrays</h2>
            <p>Display lists of items using the <code>items</code> attribute with JSON arrays.</p>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>Fruits</h3>
                    <ck-primitive-array 
                        name="Shopping List" 
                        items='["Apple", "Banana", "Cherry", "Date"]'>
                    </ck-primitive-array>
                </div>
                <div class="demo-item">
                    <h3>Programming Languages</h3>
                    <ck-primitive-array 
                        name="Tech Stack" 
                        items='["JavaScript", "TypeScript", "Python"]'
                        color="#0066cc">
                    </ck-primitive-array>
                </div>
            </div>
            <pre><code><span class="keyword">&lt;ck-primitive-array</span>
    <span class="highlight">name</span>=<span class="string">"Shopping List"</span>
    <span class="highlight">items</span>=<span class="string">'["Apple", "Banana", "Cherry"]'</span><span class="keyword">&gt;
&lt;/ck-primitive-array&gt;</span></code></pre>
        </div>

        <!-- Number Coercion -->
        <div class="section">
            <h2>7. Items Attribute - Number Coercion</h2>
            <p>Numbers are automatically converted to strings.</p>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>Fibonacci Sequence</h3>
                    <ck-primitive-array 
                        name="Fibonacci" 
                        items='[1, 1, 2, 3, 5, 8, 13, 21]'
                        color="#e74c3c">
                    </ck-primitive-array>
                </div>
                <div class="demo-item">
                    <h3>Years</h3>
                    <ck-primitive-array 
                        name="Timeline" 
                        items='[2020, 2021, 2022, 2023, 2024, 2025, 2026]'
                        color="#9b59b6">
                    </ck-primitive-array>
                </div>
            </div>
            <pre><code><span class="keyword">&lt;ck-primitive-array</span>
    <span class="highlight">name</span>=<span class="string">"Fibonacci"</span>
    <span class="highlight">items</span>=<span class="string">'[1, 1, 2, 3, 5, 8, 13, 21]'</span><span class="keyword">&gt;
&lt;/ck-primitive-array&gt;</span></code></pre>
        </div>

        <!-- Boolean Coercion -->
        <div class="section">
            <h2>8. Items Attribute - Boolean Values</h2>
            <p>Booleans are converted to "true" and "false" strings.</p>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>Test Results</h3>
                    <ck-primitive-array 
                        name="Unit Tests" 
                        items='[true, true, false, true, true]'
                        color="#2ecc71">
                    </ck-primitive-array>
                </div>
            </div>
            <pre><code><span class="keyword">&lt;ck-primitive-array</span>
    <span class="highlight">name</span>=<span class="string">"Unit Tests"</span>
    <span class="highlight">items</span>=<span class="string">'[true, true, false, true]'</span><span class="keyword">&gt;
&lt;/ck-primitive-array&gt;</span></code></pre>
        </div>

        <!-- Mixed Types -->
        <div class="section">
            <h2>9. Items Attribute - Mixed Primitives</h2>
            <p>Mix strings, numbers, and booleans. Objects, arrays, and null are filtered out.</p>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>Mixed Types (objects/null filtered)</h3>
                    <ck-primitive-array 
                        name="Mixed Data" 
                        items='["text", 42, true, null, "more", {"x":1}, false, [1,2]]'
                        color="#f39c12">
                    </ck-primitive-array>
                    <p style="margin-top: 1rem; font-size: 0.9rem; color: #999;">
                        ‚ö†Ô∏è Objects, arrays, and null values are automatically filtered out
                    </p>
                </div>
            </div>
            <pre><code><span class="comment">// Renders: "text", "42", "true", "more", "false"</span>
<span class="keyword">&lt;ck-primitive-array</span>
    <span class="highlight">items</span>=<span class="string">'["text", 42, true, null, {"x":1}]'</span><span class="keyword">&gt;
&lt;/ck-primitive-array&gt;</span></code></pre>
        </div>

        <!-- Add Button Behavior -->
        <div class="section">
            <h2>10. Add Button Behavior</h2>
            <p>Click the <code>Add</code> button to append new empty items. The new input receives focus automatically. A <code>change</code> event is dispatched each time.</p>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>Empty List (click Add)</h3>
                    <ck-primitive-array id="addDemo" name="Add Demo"></ck-primitive-array>
                    <p id="addDemoLog" style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;"></p>
                </div>
                <div class="demo-item">
                    <h3>Readonly (Add disabled)</h3>
                    <ck-primitive-array name="Readonly List" readonly items='["Locked Item"]'></ck-primitive-array>
                </div>
                <div class="demo-item">
                    <h3>Disabled (Add disabled)</h3>
                    <ck-primitive-array name="Disabled List" disabled items='["Disabled Item"]'></ck-primitive-array>
                </div>
            </div>
            <pre><code><span class="comment">// Add button creates empty row, fires change event</span>
<span class="keyword">&lt;ck-primitive-array&gt;&lt;/ck-primitive-array&gt;</span>

<span class="comment">// Programmatic add with a value</span>
<span class="keyword">const</span> el = <span class="keyword">document</span>.querySelector(<span class="string">'ck-primitive-array'</span>);
el.<span class="highlight">addItem</span>(<span class="string">'Buy milk'</span>); <span class="comment">// pre-filled</span>
el.<span class="highlight">addItem</span>();             <span class="comment">// empty</span>

<span class="comment">// Readonly: Add button disabled</span>
<span class="keyword">&lt;ck-primitive-array</span> <span class="highlight">readonly</span><span class="keyword">&gt;&lt;/ck-primitive-array&gt;</span></code></pre>
        </div>

        <!-- Enter Key Functionality -->
        <div class="section">
            <h2>11. Keyboard Shortcuts - Enter Key</h2>
            <p>Press <strong>Enter</strong> while focused on any item input to add a new empty item below. Focus automatically moves to the Add button after the new item is created.</p>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>Try It: Type and Press Enter</h3>
                    <ck-primitive-array
                        id="enterKeyDemo"
                        name="Keyboard Demo"
                        items='["Type here and press Enter"]'
                        color="#8e44ad">
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Focus an input, press Enter ‚Üí New row added ‚Üí Focus moves to Add button
                    </p>
                </div>
                <div class="demo-item">
                    <h3>Readonly (Enter has no effect)</h3>
                    <ck-primitive-array
                        name="Readonly"
                        readonly
                        items='["Press Enter here"]'
                        color="#95a5a6">
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #999;">
                        ‚ö†Ô∏è Enter key is disabled when readonly attribute is set
                    </p>
                </div>
            </div>
            <pre><code><span class="comment">// User presses Enter in any item input:</span>
<span class="comment">// 1. New empty item added below</span>
<span class="comment">// 2. Original input value preserved</span>
<span class="comment">// 3. Focus moves to Add button</span>
<span class="comment">// 4. 'change' event dispatched</span>

<span class="comment">// Readonly blocks Enter key:</span>
<span class="keyword">&lt;ck-primitive-array</span> <span class="highlight">readonly</span> <span class="highlight">items</span>=<span class="string">'["locked"]'</span><span class="keyword">&gt;&lt;/ck-primitive-array&gt;</span></code></pre>
        </div>

        <!-- Ctrl/Cmd+Enter Form Submission -->
        <div class="section">
            <h2>11.5. Keyboard Shortcuts - Ctrl/Cmd+Enter Submit</h2>
            <p>Press <strong>Ctrl+Enter</strong> (Windows/Linux) or <strong>Cmd+Enter</strong> (Mac) while focused on any item input to submit the form. The focused value is saved before submission, and it works even when <code>readonly</code> is set.</p>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>Try It: Ctrl/Cmd+Enter to Submit</h3>
                    <form id="ctrlEnterForm" style="display: block;">
                        <ck-primitive-array
                            id="ctrlEnterDemo"
                            name="items"
                            items='["Type here and press Ctrl+Enter"]'
                            color="#e67e22">
                        </ck-primitive-array>
                        <button type="submit" style="margin-top: 0.5rem; padding: 0.5rem 1rem; background: #e67e22; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            Submit Form
                        </button>
                    </form>
                    <div id="ctrlEnterOutput" style="margin-top: 0.5rem; padding: 0.5rem; background: #fff3cd; border-radius: 4px; font-family: monospace; font-size: 0.8rem;">
                        <div style="color: #666;">Focus an input and press Ctrl+Enter (or Cmd+Enter on Mac)...</div>
                    </div>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Focus an input, press Ctrl+Enter ‚Üí Value saves and form submits
                    </p>
                </div>
                <div class="demo-item">
                    <h3>Not in a Form (No Effect)</h3>
                    <ck-primitive-array
                        name="standalone"
                        items='["Press Ctrl+Enter here (no effect)"]'
                        color="#95a5a6">
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #999;">
                        ‚ö†Ô∏è Ctrl/Cmd+Enter only works when component is inside a form element
                    </p>
                </div>
            </div>
            <pre><code><span class="comment">// User presses Ctrl+Enter (or Cmd+Enter on Mac) in item input:</span>
<span class="comment">// 1. Form submits immediately (if component is in a form)</span>
<span class="comment">// 2. Focused input value is saved before submit</span>
<span class="comment">// 3. Regular Enter still adds new items</span>
<span class="comment">// 4. Works cross-platform (Ctrl on Windows/Linux, Cmd on Mac)</span>

<span class="keyword">&lt;form</span> <span class="highlight">id</span>=<span class="string">"myForm"</span><span class="keyword">&gt;</span>
  <span class="keyword">&lt;ck-primitive-array</span> <span class="highlight">name</span>=<span class="string">"tags"</span> <span class="highlight">items</span>=<span class="string">'["task1","task2"]'</span><span class="keyword">&gt;&lt;/ck-primitive-array&gt;</span>
<span class="keyword">&lt;/form&gt;</span></code></pre>
        </div>

        <script>
            // Ctrl/Cmd+Enter demo event handler
            const ctrlEnterForm = document.getElementById('ctrlEnterForm');
            const ctrlEnterOutput = document.getElementById('ctrlEnterOutput');

            if (ctrlEnterForm && ctrlEnterOutput) {
                ctrlEnterForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const formData = new FormData(ctrlEnterForm);
                    const items = formData.getAll('items[]');
                    ctrlEnterOutput.innerHTML = `
                        <div style="color: #27ae60; font-weight: bold;">Form Submitted via Ctrl/Cmd+Enter!</div>
                        <div>items[] = ${JSON.stringify(items)}</div>
                        <div style="margin-top: 0.5rem; color: #666; font-size: 0.75rem;">Try focusing an input and pressing Ctrl+Enter again</div>
                    `;
                });
            }
        </script>

        <!-- Inline Edit -->
        <div class="section">
            <h2>12. Inline Edit Features</h2>
            <p>Edit items directly with real-time updates, form integration, accessibility, and validation.</p>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
                <div class="demo-item">
                    <h3>Change Events on Every Keystroke</h3>
                    <ck-primitive-array
                        id="editDemo"
                        name="Edit Demo"
                        items='["Type here"]'
                        color="#3498db">
                    </ck-primitive-array>
                    <div id="editEventLog" style="margin-top: 0.5rem; padding: 0.5rem; background: #f8f9fa; border-radius: 4px; font-family: monospace; font-size: 0.8rem; max-height: 100px; overflow-y: auto;">
                        <div style="color: #666;">Event log (last 5 changes)...</div>
                    </div>
                </div>
                <div class="demo-item">
                    <h3>Form Integration (Hidden Inputs)</h3>
                    <form id="demoForm" style="display: inline-block;">
                        <ck-primitive-array
                            name="tags"
                            items='["react","vue","angular"]'
                            color="#2ecc71">
                        </ck-primitive-array>
                        <button type="submit" style="margin-top: 0.5rem; padding: 0.5rem 1rem; background: #2ecc71; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            Submit Form
                        </button>
                    </form>
                    <div id="formData" style="margin-top: 0.5rem; padding: 0.5rem; background: #f8f9fa; border-radius: 4px; font-family: monospace; font-size: 0.8rem;">
                        <div style="color: #666;">Form data will appear here...</div>
                    </div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                <div class="demo-item">
                    <h3>Soft Delete & Undo</h3>
                    <style>
                        ck-primitive-array::part(deleted) input {
                            opacity: 0.6;
                            text-decoration: line-through;
                        }
                    </style>
                    <ck-primitive-array
                        id="softDeleteDemo"
                        name="tasks"
                        items='["Write tests","Implement feature","Deploy"]'
                        color="#3498db">
                    </ck-primitive-array>
                    <div id="softDeleteLog" style="margin-top: 0.5rem; padding: 0.5rem; background: #f8f9fa; border-radius: 4px; font-family: monospace; font-size: 0.8rem;">
                        <strong>Active:</strong> 3 item(s)<br>
                        <strong>Deleted:</strong> 0 item(s)<br>
                        <strong>Total:</strong> 3 item(s)
                    </div>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Click "Delete" to soft-delete an item, "Undo" to restore it
                    </p>
                </div>
                <div class="demo-item">
                    <h3>Form Participation with deleted-name</h3>
                    <form id="formParticipationDemo" style="display: inline-block; width: 100%;">
                        <ck-primitive-array
                            id="formParticipationArray"
                            name="active"
                            deleted-name="removed"
                            items='["Task A","Task B"]'
                            color="#8e44ad">
                        </ck-primitive-array>
                        <button type="submit" style="margin-top: 0.5rem; padding: 0.5rem 1rem; background: #8e44ad; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            Submit Form
                        </button>
                    </form>
                    <div id="formParticipationOutput" style="margin-top: 0.5rem; padding: 0.5rem; background: #f8f9fa; border-radius: 4px; font-family: monospace; font-size: 0.8rem;">
                        <strong>active[]:</strong> Task A, Task B<br>
                        <strong>removed[]:</strong> (none)
                    </div>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Soft-delete an item to see it move from "active[]" to "removed[]"
                    </p>
                </div>
                <div class="demo-item">
                    <h3>Validation (Empty Values)</h3>
                    <style>
                        .ck-primitive-array__item.has-error input {
                            border: 2px solid #e74c3c;
                            background: #fee;
                        }
                        .ck-primitive-array__item.has-error input:focus {
                            outline-color: #e74c3c;
                        }
                    </style>
                    <ck-primitive-array
                        id="validationDemo"
                        name="Validation"
                        items='["Clear this text to see error"]'
                        color="#e74c3c">
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Clear the input to trigger validation error (red border)
                    </p>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr; gap: 1.5rem;">
                <div class="demo-item">
                    <h3>ARIA Labels (Accessibility)</h3>
                    <ck-primitive-array
                        id="ariaDemo"
                        name="ARIA Demo"
                        items='["apple"]'
                        color="#9b59b6">
                    </ck-primitive-array>
                    <div id="ariaLabel" style="margin-top: 0.5rem; padding: 0.5rem; background: #f8f9fa; border-radius: 4px; font-family: monospace; font-size: 0.8rem;">
                        <div style="color: #666;">Current aria-label: "Item: apple"</div>
                    </div>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Edit the input to see the ARIA label update
                    </p>
                </div>
            </div>

            <pre><code><span class="comment">// Change events fire on every keystroke:</span>
<span class="keyword">element</span>.addEventListener(<span class="string">'change'</span>, <span class="keyword">(e)</span> => {
  console.log(<span class="string">'Items:'</span>, e.detail.items);
});

<span class="comment">// Form integration with hidden inputs:</span>
<span class="keyword">&lt;ck-primitive-array</span> <span class="highlight">name</span>=<span class="string">"tags"</span> <span class="highlight">items</span>=<span class="string">'["a","b"]'</span><span class="keyword">&gt;&lt;/ck-primitive-array&gt;</span>
<span class="comment">// Creates: &lt;input type="hidden" name="tags[]" value="a" /&gt;</span>
<span class="comment">//          &lt;input type="hidden" name="tags[]" value="b" /&gt;</span>

<span class="comment">// Validation: empty values get aria-invalid + .has-error class</span>
<span class="comment">// ARIA labels update dynamically: aria-label="Item: {value}"</span></code></pre>
        </div>

        <script>
            // Edit demo - log change events
            const editDemo = document.getElementById('editDemo');
            const editEventLog = document.getElementById('editEventLog');
            let eventCount = 0;
            const maxLogs = 5;
            const logs = [];

            editDemo.addEventListener('change', (e) => {
                eventCount++;
                const value = e.detail.items[0]?.value || '(empty)';
                logs.unshift(`#${eventCount}: "${value}"`);
                if (logs.length > maxLogs) logs.pop();
                editEventLog.innerHTML = logs.map(log => `<div>${log}</div>`).join('');
            });

            // Form demo - show form data on submit
            const demoForm = document.getElementById('demoForm');
            const formDataDiv = document.getElementById('formData');

            demoForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const formData = new FormData(demoForm);
                const tags = formData.getAll('tags[]');
                formDataDiv.innerHTML = `
                    <div style="color: #2ecc71; font-weight: bold;">Form Submitted!</div>
                    <div>tags[] = ${JSON.stringify(tags)}</div>
                `;
            });

            // ARIA demo - show current aria-label
            const ariaDemo = document.getElementById('ariaDemo');
            const ariaLabel = document.getElementById('ariaLabel');

            ariaDemo.addEventListener('change', () => {
                const input = ariaDemo.shadowRoot.querySelector('input[type="text"]');
                const label = input?.getAttribute('aria-label') || 'N/A';
                ariaLabel.innerHTML = `<div style="color: #9b59b6;">Current aria-label: "${label}"</div>`;
            });
        </script>

        <!-- Form Submission & Validation -->
        <div class="section">
            <h2>13. Form Submission & Validation</h2>
            <p>The component participates in standard HTML forms via hidden inputs. Use <code>checkValidity()</code> to validate before submission.</p>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                <div class="demo-item">
                    <h3>Form Submission</h3>
                    <form id="formSubmitDemo">
                        <ck-primitive-array
                            id="formSubmitArray"
                            name="fruits"
                            deleted-name="removed-fruits"
                            items='["apple","banana","cherry"]'>
                        </ck-primitive-array>
                        <button type="submit" style="margin-top: 0.5rem; padding: 0.5rem 1rem; background: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            Submit Form
                        </button>
                    </form>
                    <div id="formSubmitOutput" style="margin-top: 0.5rem; padding: 0.5rem; background: #f8f9fa; border-radius: 4px; font-family: monospace; font-size: 0.8rem;">
                        <div style="color: #666;">Submit to see FormData...</div>
                    </div>
                </div>
                <div class="demo-item">
                    <h3>Validation (checkValidity)</h3>
                    <ck-primitive-array
                        id="validationCheckDemo"
                        name="tasks"
                        items='["Write tests",""]'>
                    </ck-primitive-array>
                    <button type="button" id="checkValidityBtn" style="margin-top: 0.5rem; padding: 0.5rem 1rem; background: #e67e22; color: white; border: none; border-radius: 4px; cursor: pointer;">
                        Check Validity
                    </button>
                    <div id="validityOutput" style="margin-top: 0.5rem; padding: 0.5rem; background: #f8f9fa; border-radius: 4px; font-family: monospace; font-size: 0.8rem;">
                        <div style="color: #666;">Click to check validity...</div>
                    </div>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        Fill in the empty item to make it valid
                    </p>
                </div>
            </div>

            <pre><code><span class="comment">// Check validity before submission</span>
<span class="keyword">const</span> el = <span class="keyword">document</span>.querySelector(<span class="string">'ck-primitive-array'</span>);
<span class="keyword">if</span> (el.<span class="highlight">checkValidity</span>()) {
  form.submit();
} <span class="keyword">else</span> {
  alert(<span class="string">'Please fill in all items'</span>);
}

<span class="comment">// Collect FormData</span>
<span class="keyword">const</span> formData = <span class="keyword">new</span> FormData(form);
<span class="keyword">const</span> items = formData.getAll(<span class="string">'fruits[]'</span>);
<span class="keyword">const</span> removed = formData.getAll(<span class="string">'removed-fruits[]'</span>);</code></pre>
        </div>

        <script>
            // Form submission demo
            const formSubmitDemo = document.getElementById('formSubmitDemo');
            const formSubmitOutput = document.getElementById('formSubmitOutput');

            if (formSubmitDemo && formSubmitOutput) {
                formSubmitDemo.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const formData = new FormData(formSubmitDemo);
                    const active = formData.getAll('fruits[]');
                    const removed = formData.getAll('removed-fruits[]');
                    formSubmitOutput.innerHTML = `
                        <div style="color: #27ae60; font-weight: bold;">Form Submitted!</div>
                        <div>fruits[] = ${JSON.stringify(active)}</div>
                        <div>removed-fruits[] = ${JSON.stringify(removed)}</div>
                    `;
                });
            }

            // Validation demo
            const checkValidityBtn = document.getElementById('checkValidityBtn');
            const validationCheckDemo = document.getElementById('validationCheckDemo');
            const validityOutput = document.getElementById('validityOutput');

            if (checkValidityBtn && validationCheckDemo && validityOutput) {
                checkValidityBtn.addEventListener('click', () => {
                    const isValid = validationCheckDemo.checkValidity();
                    validityOutput.innerHTML = isValid
                        ? '<div style="color: #27ae60; font-weight: bold;">Valid! All items have values.</div>'
                        : '<div style="color: #e74c3c; font-weight: bold;">Invalid! Some items are empty.</div>';
                });
            }
        </script>

        <!-- Dynamic Items -->
        <div class="section">
            <h2>14. Dynamic Items via JavaScript</h2>
            <p>Add and update items programmatically using the <code>items</code> property.</p>
            <div class="controls">
                <div class="control-group">
                    <label for="itemInput">Add Item:</label>
                    <input type="text" id="itemInput" placeholder="Type an item and press Enter">
                </div>
                <button id="clearItemsBtn">Clear All Items</button>
            </div>
            <div style="margin-top: 1rem;">
                <ck-primitive-array 
                    id="dynamicItems" 
                    name="Dynamic List"
                    color="#1abc9c">
                </ck-primitive-array>
            </div>
                <pre><code><span class="keyword">const</span> element = <span class="keyword">document</span>.querySelector(<span class="string">'ck-primitive-array'</span>);
        element.<span class="highlight">items</span> = [<span class="string">'Item 1'</span>, <span class="string">'Item 2'</span>, <span class="string">'Item 3'</span>];

        <span class="comment">// Add a new item</span>
        <span class="keyword">const</span> values = element.items.map(item => item.value);
        element.<span class="highlight">items</span> = [...values, <span class="string">'New Item'</span>];</code></pre>
        </div>

        <!-- Input Synchronization -->
        <div class="section">
            <h2>15. Input Synchronization (Form Integration)</h2>
            <p>Hidden inputs automatically synchronize with component state for form submission.</p>
            <p><strong>Try:</strong> Add items, edit values, soft-delete items, then check the form data below.</p>

            <form id="syncForm" style="background: #f8f9fa; padding: 1rem; border-radius: 4px; margin-bottom: 1rem;">
                <ck-primitive-array
                    id="syncDemo"
                    name="tags"
                    deleted-name="removed-tags"
                    items='["apple","banana","cherry"]'>
                </ck-primitive-array>
                <button type="button" onclick="event.preventDefault(); document.getElementById('syncFormData').textContent = new FormData(document.getElementById('syncForm')).getAll('tags[]').join(', ') || '(none)'; document.getElementById('syncDeletedData').textContent = new FormData(document.getElementById('syncForm')).getAll('removed-tags[]').join(', ') || '(none)';">Show Form Data</button>
            </form>

            <div style="background: #fff3cd; padding: 1rem; border-radius: 4px; margin-bottom: 1rem;">
                <p style="margin: 0 0 0.5rem 0;"><strong>Active Items (tags[]):</strong> <span id="syncFormData" style="font-family: monospace;">(click Show Form Data)</span></p>
                <p style="margin: 0;"><strong>Deleted Items (removed-tags[]):</strong> <span id="syncDeletedData" style="font-family: monospace;">(click Show Form Data)</span></p>
            </div>

            <h3>Synchronization Triggers</h3>
            <ul style="line-height: 1.8;">
                <li>‚úÖ <strong>Initial Load</strong>: Hidden inputs created when items attribute is set</li>
                <li>‚úÖ <strong>Add Operation</strong>: New hidden input created when item is added</li>
                <li>‚úÖ <strong>Edit Operation</strong>: Hidden input value updated (same DOM node, no replacement)</li>
                <li>‚úÖ <strong>Soft Delete</strong>: Hidden input name transitions to <code>deleted-name[]</code></li>
                <li>‚úÖ <strong>Undo</strong>: Hidden input name transitions back to <code>name[]</code></li>
                <li>‚úÖ <strong>Hard Remove</strong>: Hidden input permanently removed from DOM</li>
                <li>‚úÖ <strong>Items Attribute Update</strong>: All hidden inputs refreshed to match new items</li>
            </ul>

            <h3>Example: Items Attribute Re-parse</h3>
            <div class="controls">
                <button onclick="document.getElementById('syncDemo').setAttribute('items', JSON.stringify(['red','green','blue']))">Set Items: red, green, blue</button>
                <button onclick="document.getElementById('syncDemo').setAttribute('items', JSON.stringify(['one','two','three','four']))">Set Items: one, two, three, four</button>
                <button onclick="document.getElementById('syncDemo').setAttribute('items', '[]')">Clear All Items</button>
            </div>

            <div style="margin-top: 1rem;">
                <p style="font-size: 0.9rem; color: #666;"><em>Note: Hidden inputs are in the light DOM (not shadow DOM) so they participate in form submission. Inspect the element to see them!</em></p>
            </div>

                <pre><code><span class="comment">// Form submission always reflects current state</span>
<span class="keyword">const</span> form = <span class="keyword">document</span>.querySelector(<span class="string">'form'</span>);
<span class="keyword">const</span> formData = <span class="keyword">new</span> FormData(form);

<span class="comment">// Get active items</span>
<span class="keyword">const</span> activeTags = formData.getAll(<span class="string">'tags[]'</span>);
<span class="keyword">console</span>.log(<span class="string">'Active:'</span>, activeTags);

<span class="comment">// Get soft-deleted items</span>
<span class="keyword">const</span> deletedTags = formData.getAll(<span class="string">'removed-tags[]'</span>);
<span class="keyword">console</span>.log(<span class="string">'Deleted:'</span>, deletedTags);</code></pre>
        </div>

        <!-- Validation -->
        <div class="section">
            <h2>16. Validation & Constraints</h2>
            <p>The component supports comprehensive validation including empty/whitespace rejection, duplicates, length constraints, pattern matching, and list-level constraints.</p>

            <h3>Empty & Whitespace Rejection</h3>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>Default Behavior</h3>
                    <ck-primitive-array
                        id="emptyValidationDemo"
                        name="default"
                        items='[""]'>
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Empty inputs show validation error with aria-invalid=true
                    </p>
                </div>
                <div class="demo-item">
                    <h3>Whitespace Only</h3>
                    <ck-primitive-array
                        name="whitespace"
                        items='["   "]'>
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Whitespace-only inputs are treated as empty
                    </p>
                </div>
            </div>

            <h3>Duplicate Detection</h3>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>Rejects Duplicates (Default)</h3>
                    <ck-primitive-array
                        id="noDupsDemo"
                        name="noDups"
                        items='["apple","banana"]'>
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Try editing banana to apple - error appears
                    </p>
                </div>
                <div class="demo-item">
                    <h3>Allow Duplicates</h3>
                    <ck-primitive-array
                        allow-duplicates
                        name="allowDups"
                        items='["apple","banana"]'>
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° With <code>allow-duplicates</code> attribute, no error
                    </p>
                </div>
            </div>

            <h3>Length Constraints</h3>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>minlength="3"</h3>
                    <ck-primitive-array
                        minlength="3"
                        name="minLength"
                        items='["ab"]'>
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Values shorter than 3 chars show error
                    </p>
                </div>
                <div class="demo-item">
                    <h3>maxlength="5"</h3>
                    <ck-primitive-array
                        maxlength="5"
                        name="maxLength"
                        items='["toolong"]'>
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Values longer than 5 chars show error
                    </p>
                </div>
            </div>

            <h3>Pattern Matching</h3>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>Email Pattern</h3>
                    <ck-primitive-array
                        pattern="[a-z0-9._%+\-]+@[a-z0-9.\-]+\.[a-z]{2,}"
                        name="emails"
                        items='["test@example.com","invalid-email"]'>
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Edit second item - format must match email pattern
                    </p>
                </div>
                <div class="demo-item">
                    <h3>Hex Color Pattern</h3>
                    <ck-primitive-array
                        pattern="[0-9a-f]{3}([0-9a-f]{3})?"
                        name="colors"
                        items='["fff","FF5500"]'>
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Only 3 or 6 digit hex codes match pattern
                    </p>
                </div>
            </div>

            <h3>List-Level Constraints</h3>
            <div class="demo-grid">
                <div class="demo-item">
                    <h3>required</h3>
                    <ck-primitive-array
                        required
                        name="required"
                        items='[]'>
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° At least one active item required
                    </p>
                </div>
                <div class="demo-item">
                    <h3>min="2" max="4"</h3>
                    <ck-primitive-array
                        min="2"
                        max="4"
                        name="minmax"
                        items='["item1"]'>
                    </ck-primitive-array>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Must have 2-4 active items; Add button disables at max
                    </p>
                </div>
            </div>

            <h3>Validation Methods</h3>
            <pre><code><span class="comment">// Check validity before submission</span>
<span class="keyword">const</span> element = <span class="keyword">document</span>.querySelector(<span class="string">'ck-primitive-array'</span>);
<span class="keyword">if</span> (!element.<span class="highlight">checkValidity</span>()) {
  alert(<span class="string">'Please fix validation errors'</span>);
  <span class="keyword">return</span>;
}

<span class="comment">// Attributes support all constraints:</span>
<span class="keyword">&lt;ck-primitive-array</span>
  <span class="highlight">required</span>
  <span class="highlight">min</span>=<span class="string">"2"</span>
  <span class="highlight">max</span>=<span class="string">"5"</span>
  <span class="highlight">minlength</span>=<span class="string">"3"</span>
  <span class="highlight">maxlength</span>=<span class="string">"20"</span>
  <span class="highlight">pattern</span>=<span class="string">"^[a-z]+$"</span>
  <span class="highlight">allow-duplicates</span>
<span class="keyword">&gt;&lt;/ck-primitive-array&gt;</span></code></pre>
        </div>
    </div>

    <script type="module">
        // Import the component from the built distribution
        import '../dist/ck-primitive-array/ck-primitive-array.esm.js';

        // Setup dynamic controls
        const dynamicComponent = document.getElementById('dynamicComponent');
        const nameInput = document.getElementById('nameInput');
        const colorInput = document.getElementById('colorInput');

        nameInput.addEventListener('input', (e) => {
            dynamicComponent.name = e.target.value || 'World';
        });

        colorInput.addEventListener('input', (e) => {
            dynamicComponent.color = e.target.value;
        });

        // Setup programmatic creation button
        const createBtn = document.getElementById('createBtn');
        const container = document.getElementById('programmatic-container');
        let counter = 0;

        createBtn.addEventListener('click', () => {
            counter++;
            const colors = ['#e74c3c', '#3498db', '#2ecc71', '#f39c12', '#9b59b6', '#1abc9c'];
            const element = document.createElement('ck-primitive-array');

        // Setup add demo change event listener
        const addDemo = document.getElementById('addDemo');
        const addDemoLog = document.getElementById('addDemoLog');
        if (addDemo && addDemoLog) {
            addDemo.addEventListener('change', (e) => {
                const items = e.detail?.items || [];
                addDemoLog.textContent = `change event: ${items.length} item(s)`;
            });
        }

        // Setup dynamic items
        const dynamicItems = document.getElementById('dynamicItems');
        const itemInput = document.getElementById('itemInput');
        const clearItemsBtn = document.getElementById('clearItemsBtn');

        itemInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && e.target.value.trim()) {
                const currentItems = dynamicItems.items || [];
                const values = currentItems.map(item => item.value);
                dynamicItems.items = [...values, e.target.value.trim()];
                e.target.value = '';
            }
        });

        clearItemsBtn.addEventListener('click', () => {
            dynamicItems.items = [];
        });

        // Setup soft delete demo
        const softDeleteDemo = document.getElementById('softDeleteDemo');
        const softDeleteLog = document.getElementById('softDeleteLog');
        if (softDeleteDemo && softDeleteLog) {
            softDeleteDemo.addEventListener('change', (e) => {
                const active = e.detail?.active || [];
                const deleted = e.detail?.deleted || [];
                softDeleteLog.innerHTML = `
                    <strong>Active:</strong> ${active.length} item(s)<br>
                    <strong>Deleted:</strong> ${deleted.length} item(s)<br>
                    <strong>Total:</strong> ${e.detail?.items.length} item(s)
                `;
            });
        }

        // Setup form participation demo
        const formParticipationArray = document.getElementById('formParticipationArray');
        const formParticipationOutput = document.getElementById('formParticipationOutput');
        const formParticipationDemo = document.getElementById('formParticipationDemo');
        if (formParticipationArray && formParticipationOutput) {
            formParticipationArray.addEventListener('change', (e) => {
                const active = e.detail?.active || [];
                const deleted = e.detail?.deleted || [];
                formParticipationOutput.innerHTML = `
                    <strong>active[]:</strong> ${active.length > 0 ? active.join(', ') : '(none)'}<br>
                    <strong>removed[]:</strong> ${deleted.length > 0 ? deleted.join(', ') : '(none)'}
                `;
            });
            
            if (formParticipationDemo) {
                formParticipationDemo.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const formData = new FormData(formParticipationDemo);
                    const activeItems = formData.getAll('active[]');
                    const removedItems = formData.getAll('removed[]');
                    alert(`Form submitted!\n\nactive[]: ${activeItems.join(', ') || '(none)'}\nremoved[]: ${removedItems.join(', ') || '(none)'}`);
                });
            }
        }

        // Setup hard remove demo (Section 12)
        const hardRemoveSection = document.createElement('section');
        hardRemoveSection.className = 'demo-section';
        hardRemoveSection.innerHTML = `
            <div class="demo-card">
                <h3>Hard Remove (Permanent Deletion)</h3>
                <p class="description">
                    Click the "X" button to permanently remove an item. Unlike soft delete, hard remove cannot be undone.
                </p>

                <ck-primitive-array
                    id="hardRemoveDemo"
                    name="tasks"
                    items='["Task 1", "Task 2", "Task 3"]'>
                </ck-primitive-array>

                <div class="output" id="hard-remove-output">
                    <p><strong>Total Items:</strong> <span id="hard-remove-count">3</span></p>
                    <p><strong>Items:</strong> <span id="hard-remove-list">Task 1, Task 2, Task 3</span></p>
                    <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">
                        üí° Click the "X" button on any item to permanently remove it
                    </p>
                </div>
            </div>
        `;

        // Add section before script tags
        document.body.querySelector('main')?.appendChild(hardRemoveSection);

        // Setup hard remove demo event listener
        setTimeout(() => {
            const hardRemoveDemo = document.getElementById('hardRemoveDemo');
            const hardRemoveCount = document.getElementById('hard-remove-count');
            const hardRemoveList = document.getElementById('hard-remove-list');

            if (hardRemoveDemo && hardRemoveCount && hardRemoveList) {
                hardRemoveDemo.addEventListener('change', (e) => {
                    const items = e.detail?.items || [];
                    hardRemoveCount.textContent = items.length;
                    hardRemoveList.textContent = items.map(item => item.value).join(', ') || '(no items)';
                });
            }
        }, 100);
            element.name = `Dynamic #${counter}`;
            element.color = colors[counter % colors.length];
            element.style.marginBottom = '1rem';
            container.appendChild(element);
        });
    </script>
</body>
</html>
